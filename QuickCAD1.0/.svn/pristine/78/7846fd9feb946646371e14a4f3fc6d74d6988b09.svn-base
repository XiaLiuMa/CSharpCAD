using Max.BaseKit;
using Max.BaseKit.Utils;
using Max.ISolator.Core.Mods;

namespace IsolatorTarget.Business.Services
{
    /// <summary>
    /// 时间同步服务
    /// </summary>
    public class TimeSyncService
    {
        /// <summary>
        /// 消费数据
        /// </summary>
        /// <param name="idata">数据</param>
        public void ConsumeData(IsolatorData idata)
        {
            try
            {
                idata.Lst.FirstOrDefault().TryGetValue("SystemTime", out var timeStr);
                if (timeStr == null || string.IsNullOrEmpty((string)timeStr)) return;
                DateTime dateTime = Convert.ToDateTime(timeStr);
                SystemUtil.SetSystemTime(dateTime);//设置系统时间
            }
            catch (Exception ex)
            {
                NLogger.Error($"TimeSyncService消费{idata.Cmd}异常{ex.Message}。");
            }
        }
    }
}
