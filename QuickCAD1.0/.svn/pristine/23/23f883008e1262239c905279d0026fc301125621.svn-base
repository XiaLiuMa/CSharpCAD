//using Max.DbTool.SqlExtend.Mod;
//using Microsoft.AspNetCore.Mvc;
//using DataSyncSource.Config;
//using DataSyncSource.Config.Entities;
//using System.Collections.Generic;

//namespace DataSyncSource.WebApi
//{
//    /// <summary>
//    /// Ms数据库管理
//    /// </summary>
//    [Route("app/res_mssjk/[action]")]
//    public class Res_mssjkController : Controller
//    {
//        private MsDbDal dal = new MsDbDal();

//        /// <summary>
//        /// 查询MsDb
//        /// </summary>
//        /// <param name="condition"></param>
//        /// <returns></returns>
//        [HttpGet]
//        public ActionResult query(string condition)
//        {
//            string qwhere = string.IsNullOrEmpty(condition) ? "" : $"and DbIp like '%{condition}%'";
//            string where = $"1=1 {qwhere}";
//            var list = dal.Select(where);
//            return Json(list);
//        }

//        /// <summary>
//        /// 分页查询MsDb
//        /// </summary>
//        /// <param name="condition"></param>
//        /// <param name="page"></param>
//        /// <param name="rows"></param>
//        /// <returns></returns>
//        [HttpGet]
//        public ActionResult limit(string condition, string page, string rows)
//        {
//            int count = 0;
//            List<SourceDb> list = new List<SourceDb>();
//            string qwhere = string.IsNullOrEmpty(condition) ? "" : $"and DbIp like '%{condition}%'";
//            string where = $"1=1 {qwhere}";
//            var flag = dal.SqliteSelectPage(where, int.Parse(page), int.Parse(rows), out list, out count);
//            OutPage<SourceDb> outpage = new OutPage<SourceDb>()
//            {
//                Count = count,
//                Datas = list
//            };
//            return Json(outpage);
//        }

//        /// <summary>
//        /// 新增MsDb
//        /// </summary>
//        /// <param name="flag"></param>
//        /// <param name="dname"></param>
//        /// <param name="dip"></param>
//        /// <param name="port"></param>
//        /// <param name="uname"></param>
//        /// <param name="pwd"></param>
//        /// <param name="des"></param>
//        /// <returns></returns>
//        [HttpPost]
//        public ActionResult add(string flag, string dname, string dip, string port, string uname, string pwd, string des)
//        {
//            SourceDb db = new SourceDb()
//            {
//                Id = flag,
//                DbName = dname,
//                DbIp = dip,
//                DbPort = port,
//                Uname = uname,
//                Pwd = pwd,
//                Des = des
//            };
//            var _flag = dal.Add(db);
//            if (_flag) MsDbManger.Instance.RefreshLst();
//            return Json(_flag);
//        }

//        /// <summary>
//        /// 修改MsDb
//        /// </summary>
//        /// <param name="id"></param>
//        /// <param name="flag"></param>
//        /// <param name="dname"></param>
//        /// <param name="ip"></param>
//        /// <param name="port"></param>
//        /// <param name="uname"></param>
//        /// <param name="pwd"></param>
//        /// <param name="des"></param>
//        /// <returns></returns>
//        [HttpPost]
//        public ActionResult alert(string id, string flag, string dname, string dip, string port, string uname, string pwd, string des)
//        {
//            SourceDb db = new SourceDb()
//            {
//                Id = id,
//                DbName = dname,
//                DbIp = dip,
//                DbPort = port,
//                Uname = uname,
//                Pwd = pwd,
//                Des = des
//            };
//            var _flag = dal.Update(db);
//            if (_flag) MsDbManger.Instance.RefreshLst();
//            return Json(_flag);
//        }

//        /// <summary>
//        /// 删除MsDb
//        /// </summary>
//        /// <param name="ids"></param>
//        /// <returns></returns>
//        [HttpPost]
//        public ActionResult delete(string[] ids)
//        {
//            var flags = new List<bool>();
//            foreach (var id in ids)
//            {
//                flags.Add(dal.Delete(id));
//            }
//            var flag = flags.Contains(true) ? true : false;
//            if (flag) MsDbManger.Instance.RefreshLst();
//            return Json(flag);
//        }
//    }
//}
