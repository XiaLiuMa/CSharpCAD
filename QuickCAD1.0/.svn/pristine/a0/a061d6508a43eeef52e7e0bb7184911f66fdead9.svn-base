using System.Collections.Concurrent;
using static System.Net.Mime.MediaTypeNames;

internal class Program
{
    private static void Main(string[] args)
    {
        Test();
        Console.WriteLine("Hello, World!");
        Console.ReadKey(true);
    }

    private static void Test()
    {
        BlockingCollection<int> ints = new BlockingCollection<int>(20);
        Task.Factory.StartNew(() =>
        {
            int i = 1;
            while (i < 200)
            {
                bool flag = ints.TryAdd(i);
                Console.WriteLine($"1号插入{i}：{flag}");
                i++;
                Thread.Sleep(100);
            }
        });
        Task.Factory.StartNew(() =>
        {
            int i = 1;
            while (i < 200)
            {
                bool flag = ints.TryAdd(i);
                Console.WriteLine($"2号插入{i}：{flag}");
                i++;
                Thread.Sleep(100);
            }
        });
        Task.Factory.StartNew(() =>
        {
            foreach (int item in ints.GetConsumingEnumerable())
            {
                Thread.Sleep(150);
                Console.WriteLine($"{item}    数量：{ints.Count}");
            }
        });
    }
}